{
    "collab_server" : "",
    "contents" : "library(tidyverse)\nsetwd(\"C:/Users/FORANEA110/Desktop/MINERIA/Tareas/algas/tarea_nas\")\nsource(\"metadata.R\")\nsource(\"utils.R\")\nsource(\"00-load.R\")\nsource(\"01-prepare.R\")\nsource(\"02-clean.R\")\n\n#Prepare\nsummary(data)\nproblems(data)\ndata[20,]\ndata[problems(data)$row,]\n\n\n\n\n#grafica 1\ntheme_set(theme_bw())\nggplot(data, aes(fluid_velocity, a1), remove=T) +\n  geom_boxplot(outlier.shape=NA)+geom_jitter(position=position_jitter(width=.1, height=0),col = 'blue')+\n  facet_wrap(~cut_number(a1, 4))\n\n#grafica 2\nggplot(data, aes(cl, a1), remove=T) +\n  geom_hex() +\n  facet_wrap(~cut_number(a1, 4))\n\n#Nice!!!\nlibrary(GGally)\nggpairs(data, aes(colour = season, alpha = 0.4))\n\n#funcion\ndata <- data.frame(data)\nnumericvars <- character(length = ncol(data))\ncharvars <- character(length = ncol(data))\nnames <- colnames(data)\nfor(i in seq_len(ncol(data))) {\n  if(class(data[, i]) == \"numeric\") {\n    numericvars[i] <- names[i]\n  }\n  else {\n    if(class(data[, i]) == \"character\") {\n      charvars[i] <- names[i]\n  }\n  }\n}\n\nsubset_numeric <- data %>% \n  select(one_of(numericvars))\n\nsubset_chr <- data %>% \n  select(one_of(charvars))\n\nif(length(subset_numeric)!=0){\n  print(subset_numeric %>% ggpairs(alpha = 0.6))\n}\n\nif(length(subset_chr)!=0){\n  print(subset_chr %>% ggpairs())\n}\n\n\npares <- combinations(length(colnames(data)),r=2,colnames(data))\n\nfor(i in 1:(length(pares[,1]))){\n  if(as.character(pares[i,1])==as.character(pares[i,2])){\n    next #statement para no graficar mismas vars\n    }\n  else{\n    print(data %>% ggpairs(c(as.character(pares[i,1]),as.character(pares[i,2]))))\n  }\n}\n\n\nclass(iris)\nclass(data.frame(data[, 2]))\nclass(data[, 4])\ndata <- data.frame(data)\n\n\n\nauto_plot <- function(data,f){\n  \n  theme_set(theme_bw())\n  numericvars <- character(length = ncol(data))\n  charvars <- character(length = ncol(data))\n  names <- colnames(data)\n  \n  for(i in seq_len(ncol(data))) {\n    if(class(data[, i]) == \"numeric\") {\n      numericvars[i] <- names[i]\n    }\n    else {\n      if(class(data[, i]) == \"character\") {\n        charvars[i] <- names[i]\n      }\n    }\n  }\n  \n  subset_numeric <- data %>% \n    select(one_of(numericvars))\n  \n  subset_chr <- data %>% \n    select(one_of(charvars))\n  \n  if(length(subset_numeric)!=0){\n    ggpairs(subset_numeric, alpha = 0.6)\n  }\n  \n  if(length(subset_chr)!=0){\n    ggpairs(subset_chr)\n  }\n  \n  pares <- combinations(length(colnames(data)),r=2,colnames(data))\n  \n  for(i in 1:(length(pares[,1]))){\n    if(as.character(pares[i,1])==as.character(pares[i,2])){\n      next #statement para no graficar mismas vars\n    }\n    else{\n      print(data %>% ggpairs(c(as.character(pares[i,1]),as.character(pares[i,2]))))\n    }\n  }\n  \n}\n  \n\nx <- as.data.frame(abs(is.na(data))) # df es un data.frame\ny <- x[which(sapply(x, sd) > 0)] \ncor(y)\n\nlibrary(stargazer)\nsuma <- colSums(y)\nstargazer::stargazer(suma, type = \"html\", title = \"Suma de Missings por Variable\")\n\n######eJERCICIO 1\nporcentaje <- (colSums(y)/nrow(y))*100\nporcentaje\n\nlibrary(Amelia)\nmissmap(data %>% select(\"max_ph\",\"min_o2\",\"cl\",\"no3\",\"nh4\",\"opo4\",\"po4\",\"chla\"), main=\"Grafica de Missings\", \n        col=c(\"red\", \"black\"), legend=FALSE) \n\n######Ejercicio 2\nsummary(data[-grep(colnames(data),pattern = \"^a[1-9]\")]) # Nota el uso del grep\n\ndata %>%\n  select(-starts_with(\"a\")) %>%\n  summary()\n\nnrow(data[!complete.cases(data),])\n\ndata_con_NAs <- data[!complete.cases(data),]\n\ndata_con_NAs[c(\"max_ph\",\"min_o2\",\"cl\",\"no3\",\"nh4\",\"opo4\",\"po4\",\"chla\")]  %>%\n  print(n = 33)\n\n\n\n\n\nMode(test,na.rm = TRUE)\n\n\n\n# ¿Cuántos NAs hay por observación?\napply(data, 1, function(x) sum(is.na(x)))\n\ndata[apply(data, 1, function(x) sum(is.na(x))) > 2,]\n\n###SE USA LA FUNCION  indices_con_NAs\n\nindices_con_NAs(data, 0.2)\n\nindices_con_NAs(data, 0.8)\n\n# Si queremos remover las que tengan más del 20% de NAs...\ndata <- data[-indices_con_NAs(data, 0.2),]\ndim(data)\n\ndataset$cat_with_NAs_fix <- ifelse(is.na(dataset$cat_with_NAs),\n                                   \"missing\",\n                                   ifelse(dataset$ccat_with_NAs == TRUE,    \n                                          # o el valor que sea\n                                          \"level_1\",\n                                          \"level_2\"))\n\ntheme_set(theme_bw())\nggplot(data, aes(fluid_velocity, a1), remove=T) +\n  geom_boxplot(outlier.shape=NA)+geom_jitter(position=position_jitter(width=.1, height=0),col = 'blue')+\n  facet_wrap(~cut_number(a1, 4))\n\nhist(data$max_ph, prob=TRUE, breaks=10)\n\n\n# Histograms and density lines\n\ndatan <- data %>%\n  select(-starts_with(\"a\")) %>% \n  select(-which(sapply(.,is.character)))\n\npar(mfrow=c(3, 3))\ncolnames <- dimnames(datan)[[2]]\n\nfor (i in 1:8) {\n  boxplot(datan[,i], main=colnames[i], col=\"lightblue\")\n}\n\ndata %>%\n  select(-starts_with(\"a\")) %>%\n  summary()\n\n####FUncion imputar el valor central:\n\n\nmedias <- function(x,colnames){\n  x %>%\n    mutate(colnames = ifelse(is.na(max_ph),median(max_ph, na.rm = T),max_ph))\n}\n\n\nimputar_valor_central(data,\"max_ph\")\n\nsubset_numeric %>%\n  mutate(chla=ifelse(is.na(chla),median(chla, na.rm = T),chla))\n\nsubset_chr %>% \n  mutate(season = ifelse(is.na(season),getmode(season),season))\n\ndata1 <- imputar_valor_central(data,{\"chla\"})\n\n##### clase liliana 07/11\ninstall.packages(\"feather\")\nlibrary(feather)\nwrite_feather(x = iris, path='iris.feather')\n#####\n\nsummary(test)\n\n#####Ejercicio 3\n\nx <- airquality[, -1] # x is a regression design matrix\ny <- airquality[,  1] # y is the corresponding response\n\nstopifnot(complete.cases(y) != is.na(y))\nok <- complete.cases(x, y)\nsum(!ok) # how many are not \"ok\" ?\nx <- x[ok,]\ny <- y[ok]\n\n  \n  \n  ",
    "created" : 1509404106239.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2468124142",
    "id" : "B169972D",
    "lastKnownWriteTime" : 1510333374,
    "last_content_update" : 1510333374643,
    "path" : "C:/Users/FORANEA110/Desktop/MINERIA/Tareas/algas/tarea_nas/manipulando_algas_nas.R",
    "project_path" : null,
    "properties" : {
        "source_window_id" : "",
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}